# 多目標投資組合優化專案

這是一個使用 Python 進行的金融投資組合優化專案。此專案利用 **NSGA-II 多目標遺傳演算法** 來尋找一組在 **風險（波動率）與回報（夏普比率）** 之間達到最佳平衡的股票投資組合。

專案同時整合了 **代理模型（Surrogate Model）** 來加速優化過程，並包含一個 **回測框架**，用以驗證優化後投資組合在歷史數據上的實際表現。

---

## 📌 主要功能

- **多目標優化**：同時優化兩個相互衝突的目標：
  - 最小化投資組合的波動率（Minimize Volatility）
  - 最大化夏普比率（Maximize Sharpe Ratio）

- **遺傳演算法**：使用 `pymoo` 函式庫中的 **NSGA-II** 演算法來探索大量的可能性，並找出 **帕累托最優解（Pareto Front）**。

- **代理模型輔助**：使用 **高斯過程迴歸（Gaussian Process Regressor）** 作為代理模型，以減少直接評估高成本目標函數的次數，從而加速優化。

- **歷史數據回測**：將數據分為訓練集（70%）和測試集（30%），在訓練集上進行優化，並在未見過的測試集上進行回測，以評估策略的真實成效。

- **績效比較**：將 NSGA-II 優化出的最佳組合與傳統的 **馬可維茲 (Markowitz)** 最大夏普比率組合進行回測績效比較。

- **結果視覺化**：
  - 帕累托前緣圖
  - 最佳權重分佈圖
  - 多個投資組合的回測績效比較圖

---

## 🧱 環境依賴

請先安裝以下 Python 套件，建議使用虛擬環境安裝：

```bash
pip install numpy pandas yfinance pymoo pypfopt matplotlib scikit-learn
